-- VISTA INFO TRÁMITES Y SERVICIOS
CREATE VIEW v_info_ts
AS
SELECT CatTS.id_cat_tramite_servicio, CatTS.descripcion AS nombre_tramite, TS.id_tramite_servicio, TS.descripcion AS descripcion_ts, CatEnte.descripcion AS ente, TS.tiempo_respuesta, TS.beneficiario, CatMat.id_cat_materia, CatMat.descripcion AS materia, TS.is_tramite, CatMat.tramite_servicio
FROM cat_tramite_servicio CatTS 
INNER JOIN tramite_servicio TS ON TS.id_cat_tramite_servicio = CatTS.id_cat_tramite_servicio
INNER JOIN cat_ente CatEnte ON CatEnte.id_cat_ente = TS.id_ente_responsable
INNER JOIN cat_materia CatMat ON CatMat.id_cat_materia = CatTS.id_cat_materia

-- VISTA REQUISITOS
CREATE VIEW v_requisito_ts
AS
SELECT ReqTS.id_requisito_ts, CatReq.id_cat_requisito, id_tramite_servicio, CatCatReq.descripcion AS documento_oficial, CatReq.descripcion AS documento_acreditacion
FROM requisito_ts ReqTS 
INNER JOIN cat_requisito CatReq ON CatReq.id_cat_requisito = ReqTS.id_cat_requisito
INNER JOIN cat_categoria_requisito CatCatReq ON CatCatReq.id_cat_categoria_requisito = CatReq.categoria
WHERE eliminado = 1 AND CatReq.descripcion <> 'No se requiere'
ORDER BY id_tramite_servicio, categoria 

-- VISTA REQUISITOS ESPECÍFICOS
CREATE VIEW v_requisito_esp_ts
AS
SELECT id_requisito_especifico_ts, ReqEspTS.descripcion AS requisito_especifico, TS.id_tramite_servicio
FROM requisito_especifico_ts ReqEspTS
INNER JOIN tramite_servicio TS ON TS.id_tramite_servicio = ReqEspTS.id_tramite_servicio
WHERE eliminado = 1

-- FORMATOS
SELECT id_formato, id_tramite_servicio, nombre, url FROM formato_ts
WHERE eliminado = 1 

-- VISTA DOCUMENTOS
SELECT CatDoc.id_cat_documento, id_documento_ts, id_tramite_servicio, descripcion, vigencia FROM 
cat_documento CatDoc 
INNER JOIN documento_ts Doc ON CatDoc.id_cat_documento = Doc.id_cat_documento

-- VISTA AREAS DE ATENCIÓN
CREATE VIEW v_areas_atencion
AS
SELECT TS.id_tramite_servicio, nombre, calle_numero, Del.descripcion AS delegacion, Col.colonia AS colonia, cp, telefonos, url_ubicacion 
FROM tramite_servicio TS
INNER JOIN area_atencion_ts AreaAte ON AreaAte.id_tramite_servicio = TS.id_tramite_servicio
INNER JOIN cat_delegacion Del ON Del.id_cat_delegacion = AreaAte.id_delegacion
INNER JOIN cat_colonias_cp Col ON Col.id_colonia = AreaAte.id_colonia 
WHERE eliminado = 1
